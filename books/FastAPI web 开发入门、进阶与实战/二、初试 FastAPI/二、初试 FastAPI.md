# 简单项目介绍

## 1. 创建 app 实例对象

`main.py` 是应该程序服务启动入口文件，所以需要在里面实例化一个 FastAPI 的 app 实例对象，这个 app 对象是对整个应用程序服务的对象封装

```py
# create app object
app = FastAPI(
		title = 'hello test',
        description = 'this is a test',
        version = '0.1.0',
        docs_url = '',
        redoc_url = ''
		)
```



## 2. 添加 API 请求路由注册

- 路由注册：

  提供一个对应的 URL 地址来关联或绑定定义的函数

  在常见的 web 框架中，通常使用装饰器的形式对需要绑定的函数进行映射绑定，这个过程就是路由注册，也可以理解为创建视图函数的过程

- 被装饰的函数：

  被 api 请求方法装饰的函数有两种，也就是同步函数（`def`）和协程函数（`async def`）

  - 同步函数会运行于外部的线程池中，也就是基于多线程并发模式进行相关处理
  - 协程函数会运行于异步事件循环中，是基于单线程内的异步并发模式进行处理





## 3. 启动服务运行

- 在本地的开发环境中，通常直接使用 uvicorn 进行服务启动，若是在生产环境中，则需要借助 gunicorn 进行部署

  ```py
  uvicron main:app --reload
  ```

  - `--reload` 命令主要用于热启动，这个参数的主要作用是在编写代码阶段，若需要对当前代码进行改动，那么代码改动完后程序会自动重启服务的进程，使修改即时生效

- 如果希望对外允许访问服务，那么可以将 --host 参数设置为 0.0.0.0。如果希望自定义监听端口，那么可以添加 --port 参数。对外允许访问设置成功后，服务所在的局域网内的所有人都可以通过访问内网分配的端口(IP+8000)或自定义的端口来访问服务

  ```py
  uvicron main:app --reload --host 0.0.0.0 --port 8888
  ```

- 除了上述的在终端中启动服务的方式，还可以直接在代码中运行启动服务

  ```py
  if __name__ == '__main__' :
      	import uvicron
          uvicorn.run(app='main:app',host='0.0.0.0',port=8000,reload=True)
  ```

  - app 参数的三种类型：
    - 可以是 ASGIApplication 的一个实例对象（上述示例中，fastAPI 实例化后的对象就是一个 ASGIApplication 实例对象）
    - 可以是一个可调用对象
    - 可以是一个字符串，但是这个字符串必须是使用代码方式启动服务时所用的“模块名称+app 对象名”

